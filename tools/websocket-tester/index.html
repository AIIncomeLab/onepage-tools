<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>WebSocket 测试器</title>
<meta name="description" content="建立 WebSocket 连接，发送测试消息并查看返回数据。">
<link rel="stylesheet" href="/assets/styles.css">
<script src="/assets/layout.js" defer></script>
<style>
#log{height:240px;overflow:auto;background:#0f1730;border:1px solid var(--border);border-radius:12px;padding:12px;font-family:monospace;font-size:.9rem}
</style>
</head>
<body>
<header class="container site-header" data-site-header data-title="WebSocket 测试器"></header>
<main class="container card">
<label>WebSocket 地址：</label>
<input class="input" type="text" id="url" placeholder="wss://echo.websocket.org">
<div style="margin:12px 0">
<button class="btn" id="connect">连接</button>
<button class="btn" id="disconnect">断开</button>
</div>
<label>发送消息：</label>
<input class="input" type="text" id="message" placeholder="Hello">
<button class="btn" id="send" style="margin-top:8px">发送</button>
<label style="margin-top:16px">日志：</label>
<div id="log"></div>
</main>
<footer class="container site-footer" data-site-footer></footer>
<script>
const $=s=>document.querySelector(s);
let socket=null;
const log=msg=>{
  const div=document.createElement('div');
  div.textContent=`[${new Date().toLocaleTimeString()}] ${msg}`;
  $('#log').appendChild(div);
  $('#log').scrollTop=$('#log').scrollHeight;
};
$('#connect').onclick=()=>{
  const url=$('#url').value.trim();
  if(!url) return alert('请输入 WebSocket 地址');
  if(socket) socket.close();
  socket=new WebSocket(url);
  socket.addEventListener('open',()=>log('✅ 已连接'));
  socket.addEventListener('message',e=>log('⬅ 收到：'+e.data));
  socket.addEventListener('close',()=>log('❎ 连接关闭'));
  socket.addEventListener('error',()=>log('⚠️ 连接错误'));
};
$('#disconnect').onclick=()=>{ if(socket){socket.close();socket=null;} };
$('#send').onclick=()=>{
  if(!socket||socket.readyState!==WebSocket.OPEN) return alert('连接未建立');
  const msg=$('#message').value;
  socket.send(msg);
  log('➡ 发送：'+msg);
};
</script>
</body>
</html>
